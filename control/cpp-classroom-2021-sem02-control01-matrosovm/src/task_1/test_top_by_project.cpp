#include "story_points.hpp"

#include <algorithm>
#include <cassert>
#include <stdexcept>

namespace {

void CheckTopWorkersByProject() {
  std::vector<ctrl01::Task> tasks;
  for (int i = 0; i < 1000; i++) {
    const auto project = std::to_string(std::hash<int>()(i) % 13);
    const auto assignee = std::to_string(std::hash<int>()(i * 100) % 37);
    const auto sps = (int)std::hash<int>()(i * 1000);
    tasks.push_back({project, assignee, sps});
  }

  auto res1 = ctrl01::GetTopPerformersByProject(tasks);
  std::sort(res1.begin(), res1.end());
  const std::vector<ctrl01::ProjectResult> res2 = {
      {"0", {{"10", 1521000}, {"5", 1482000},  {"0", 1443000},  {"32", 1417000},
             {"27", 1391000}, {"22", 1365000}, {"17", 1339000}, {"12", 1313000},
             {"7", 1287000},  {"2", 1261000},  {"34", 1235000}, {"29", 1209000},
             {"24", 1183000}, {"19", 1157000}, {"14", 1131000}, {"9", 1105000},
             {"4", 1079000},  {"36", 1053000}, {"31", 1027000}, {"26", 1001000},
             {"21", 975000},  {"16", 949000},  {"11", 923000},  {"6", 897000},
             {"1", 871000},   {"33", 845000},  {"28", 819000},  {"23", 793000},
             {"18", 767000},  {"13", 741000},  {"8", 715000},   {"3", 689000},
             {"35", 663000},  {"30", 637000},  {"25", 611000},  {"20", 585000},
             {"15", 559000}}},
      {"1", {{"36", 1524000}, {"31", 1485000}, {"26", 1446000}, {"21", 1419000},
             {"16", 1393000}, {"11", 1367000}, {"6", 1341000},  {"1", 1315000},
             {"33", 1289000}, {"28", 1263000}, {"23", 1237000}, {"18", 1211000},
             {"13", 1185000}, {"8", 1159000},  {"3", 1133000},  {"35", 1107000},
             {"30", 1081000}, {"25", 1055000}, {"20", 1029000}, {"15", 1003000},
             {"10", 977000},  {"5", 951000},   {"0", 925000},   {"32", 899000},
             {"27", 873000},  {"22", 847000},  {"17", 821000},  {"12", 795000},
             {"7", 769000},   {"2", 743000},   {"34", 717000},  {"29", 691000},
             {"24", 665000},  {"19", 639000},  {"14", 613000},  {"9", 587000},
             {"4", 561000}}},
      {"10",
       {{"11", 1551000}, {"6", 1512000},  {"1", 1473000},  {"33", 1437000},
        {"28", 1411000}, {"23", 1385000}, {"18", 1359000}, {"13", 1333000},
        {"8", 1307000},  {"3", 1281000},  {"35", 1255000}, {"30", 1229000},
        {"25", 1203000}, {"20", 1177000}, {"15", 1151000}, {"10", 1125000},
        {"5", 1099000},  {"0", 1073000},  {"32", 1047000}, {"27", 1021000},
        {"22", 995000},  {"17", 969000},  {"12", 943000},  {"7", 917000},
        {"2", 891000},   {"34", 865000},  {"29", 839000},  {"24", 813000},
        {"19", 787000},  {"14", 761000},  {"9", 735000},   {"4", 709000},
        {"36", 683000},  {"31", 657000},  {"26", 631000},  {"21", 605000},
        {"16", 579000}}},
      {"11",
       {{"0", 1554000},  {"32", 1515000}, {"27", 1476000}, {"22", 1439000},
        {"17", 1413000}, {"12", 1387000}, {"7", 1361000},  {"2", 1335000},
        {"34", 1309000}, {"29", 1283000}, {"24", 1257000}, {"19", 1231000},
        {"14", 1205000}, {"9", 1179000},  {"4", 1153000},  {"36", 1127000},
        {"31", 1101000}, {"26", 1075000}, {"21", 1049000}, {"16", 1023000},
        {"11", 997000},  {"6", 971000},   {"1", 945000},   {"33", 919000},
        {"28", 893000},  {"23", 867000},  {"18", 841000},  {"13", 815000},
        {"8", 789000},   {"3", 763000},   {"35", 737000},  {"30", 711000},
        {"25", 685000},  {"20", 659000},  {"15", 633000},  {"10", 607000},
        {"5", 581000}}},
      {"12",
       {{"21", 1518000}, {"16", 1479000}, {"11", 1441000}, {"6", 1415000},
        {"1", 1389000},  {"33", 1363000}, {"28", 1337000}, {"23", 1311000},
        {"18", 1285000}, {"13", 1259000}, {"8", 1233000},  {"3", 1207000},
        {"35", 1181000}, {"30", 1155000}, {"25", 1129000}, {"20", 1103000},
        {"15", 1077000}, {"10", 1051000}, {"5", 1025000},  {"0", 999000},
        {"32", 973000},  {"27", 947000},  {"22", 921000},  {"17", 895000},
        {"12", 869000},  {"7", 843000},   {"2", 817000},   {"34", 791000},
        {"29", 765000},  {"24", 739000},  {"19", 713000},  {"14", 687000},
        {"9", 661000},   {"4", 635000},   {"36", 609000},  {"31", 583000},
        {"26", 557000}}},
      {"2", {{"25", 1527000}, {"20", 1488000}, {"15", 1449000}, {"10", 1421000},
             {"5", 1395000},  {"0", 1369000},  {"32", 1343000}, {"27", 1317000},
             {"22", 1291000}, {"17", 1265000}, {"12", 1239000}, {"7", 1213000},
             {"2", 1187000},  {"34", 1161000}, {"29", 1135000}, {"24", 1109000},
             {"19", 1083000}, {"14", 1057000}, {"9", 1031000},  {"4", 1005000},
             {"36", 979000},  {"31", 953000},  {"26", 927000},  {"21", 901000},
             {"16", 875000},  {"11", 849000},  {"6", 823000},   {"1", 797000},
             {"33", 771000},  {"28", 745000},  {"23", 719000},  {"18", 693000},
             {"13", 667000},  {"8", 641000},   {"3", 615000},   {"35", 589000},
             {"30", 563000}}},
      {"3", {{"14", 1530000}, {"9", 1491000},  {"4", 1452000},  {"36", 1423000},
             {"31", 1397000}, {"26", 1371000}, {"21", 1345000}, {"16", 1319000},
             {"11", 1293000}, {"6", 1267000},  {"1", 1241000},  {"33", 1215000},
             {"28", 1189000}, {"23", 1163000}, {"18", 1137000}, {"13", 1111000},
             {"8", 1085000},  {"3", 1059000},  {"35", 1033000}, {"30", 1007000},
             {"25", 981000},  {"20", 955000},  {"15", 929000},  {"10", 903000},
             {"5", 877000},   {"0", 851000},   {"32", 825000},  {"27", 799000},
             {"22", 773000},  {"17", 747000},  {"12", 721000},  {"7", 695000},
             {"2", 669000},   {"34", 643000},  {"29", 617000},  {"24", 591000},
             {"19", 565000}}},
      {"4", {{"3", 1533000},  {"35", 1494000}, {"30", 1455000}, {"25", 1425000},
             {"20", 1399000}, {"15", 1373000}, {"10", 1347000}, {"5", 1321000},
             {"0", 1295000},  {"32", 1269000}, {"27", 1243000}, {"22", 1217000},
             {"17", 1191000}, {"12", 1165000}, {"7", 1139000},  {"2", 1113000},
             {"34", 1087000}, {"29", 1061000}, {"24", 1035000}, {"19", 1009000},
             {"14", 983000},  {"9", 957000},   {"4", 931000},   {"36", 905000},
             {"31", 879000},  {"26", 853000},  {"21", 827000},  {"16", 801000},
             {"11", 775000},  {"6", 749000},   {"1", 723000},   {"33", 697000},
             {"28", 671000},  {"23", 645000},  {"18", 619000},  {"13", 593000},
             {"8", 567000}}},
      {"5", {{"29", 1536000}, {"24", 1497000}, {"19", 1458000}, {"14", 1427000},
             {"9", 1401000},  {"4", 1375000},  {"36", 1349000}, {"31", 1323000},
             {"26", 1297000}, {"21", 1271000}, {"16", 1245000}, {"11", 1219000},
             {"6", 1193000},  {"1", 1167000},  {"33", 1141000}, {"28", 1115000},
             {"23", 1089000}, {"18", 1063000}, {"13", 1037000}, {"8", 1011000},
             {"3", 985000},   {"35", 959000},  {"30", 933000},  {"25", 907000},
             {"20", 881000},  {"15", 855000},  {"10", 829000},  {"5", 803000},
             {"0", 777000},   {"32", 751000},  {"27", 725000},  {"22", 699000},
             {"17", 673000},  {"12", 647000},  {"7", 621000},   {"2", 595000},
             {"34", 569000}}},
      {"6", {{"18", 1539000}, {"13", 1500000}, {"8", 1461000},  {"3", 1429000},
             {"35", 1403000}, {"30", 1377000}, {"25", 1351000}, {"20", 1325000},
             {"15", 1299000}, {"10", 1273000}, {"5", 1247000},  {"0", 1221000},
             {"32", 1195000}, {"27", 1169000}, {"22", 1143000}, {"17", 1117000},
             {"12", 1091000}, {"7", 1065000},  {"2", 1039000},  {"34", 1013000},
             {"29", 987000},  {"24", 961000},  {"19", 935000},  {"14", 909000},
             {"9", 883000},   {"4", 857000},   {"36", 831000},  {"31", 805000},
             {"26", 779000},  {"21", 753000},  {"16", 727000},  {"11", 701000},
             {"6", 675000},   {"1", 649000},   {"33", 623000},  {"28", 597000},
             {"23", 571000}}},
      {"7", {{"7", 1542000},  {"2", 1503000},  {"34", 1464000}, {"29", 1431000},
             {"24", 1405000}, {"19", 1379000}, {"14", 1353000}, {"9", 1327000},
             {"4", 1301000},  {"36", 1275000}, {"31", 1249000}, {"26", 1223000},
             {"21", 1197000}, {"16", 1171000}, {"11", 1145000}, {"6", 1119000},
             {"1", 1093000},  {"33", 1067000}, {"28", 1041000}, {"23", 1015000},
             {"18", 989000},  {"13", 963000},  {"8", 937000},   {"3", 911000},
             {"35", 885000},  {"30", 859000},  {"25", 833000},  {"20", 807000},
             {"15", 781000},  {"10", 755000},  {"5", 729000},   {"0", 703000},
             {"32", 677000},  {"27", 651000},  {"22", 625000},  {"17", 599000},
             {"12", 573000}}},
      {"8", {{"33", 1545000}, {"28", 1506000}, {"23", 1467000}, {"18", 1433000},
             {"13", 1407000}, {"8", 1381000},  {"3", 1355000},  {"35", 1329000},
             {"30", 1303000}, {"25", 1277000}, {"20", 1251000}, {"15", 1225000},
             {"10", 1199000}, {"5", 1173000},  {"0", 1147000},  {"32", 1121000},
             {"27", 1095000}, {"22", 1069000}, {"17", 1043000}, {"12", 1017000},
             {"7", 991000},   {"2", 965000},   {"34", 939000},  {"29", 913000},
             {"24", 887000},  {"19", 861000},  {"14", 835000},  {"9", 809000},
             {"4", 783000},   {"36", 757000},  {"31", 731000},  {"26", 705000},
             {"21", 679000},  {"16", 653000},  {"11", 627000},  {"6", 601000},
             {"1", 575000}}},
      {"9", {{"22", 1548000}, {"17", 1509000}, {"12", 1470000}, {"7", 1435000},
             {"2", 1409000},  {"34", 1383000}, {"29", 1357000}, {"24", 1331000},
             {"19", 1305000}, {"14", 1279000}, {"9", 1253000},  {"4", 1227000},
             {"36", 1201000}, {"31", 1175000}, {"26", 1149000}, {"21", 1123000},
             {"16", 1097000}, {"11", 1071000}, {"6", 1045000},  {"1", 1019000},
             {"33", 993000},  {"28", 967000},  {"23", 941000},  {"18", 915000},
             {"13", 889000},  {"8", 863000},   {"3", 837000},   {"35", 811000},
             {"30", 785000},  {"25", 759000},  {"20", 733000},  {"15", 707000},
             {"10", 681000},  {"5", 655000},   {"0", 629000},   {"32", 603000},
             {"27", 577000}}}};
  assert(res1 == res2);
}

} // namespace

int main() { CheckTopWorkersByProject(); }